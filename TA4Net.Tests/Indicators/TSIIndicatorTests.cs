using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Text;
using TA4Net.Indicators;
using TA4Net.Interfaces;
using TA4Net.Mocks;

namespace TA4Net.Tests.indicators
{
    [TestClass]
    public class TSIIndicatorTests
    {
        [TestMethod]
        public void GetValue()
        {
            var indicator = new TSIIndicator(GetTimeSeries());

            Assert.AreEqual(-7.937727578440073239062313560M, indicator.GetValue(140));
            Assert.AreEqual(-1.2566679881258167222559060300M, indicator.GetValue(328));
            Assert.AreEqual(0.0026704022313331039048103200M, indicator.GetValue(329));
            Assert.AreEqual(1.1814524309088740701120690500M, indicator.GetValue(330));

            Assert.AreEqual(-1.0027285819940844569966280900M, indicator.GetValue(453));
            Assert.AreEqual(1.9174654666886379394230722200M, indicator.GetValue(454));

            Assert.AreEqual(-29.791816901834688042794413850M, indicator.GetValue(437));

            Assert.AreEqual(25.994370814508765629804458070M, indicator.GetValue(500));
            Assert.AreEqual(25.352986506921396964283626500M, indicator.GetValue(501));
        }

        // Big ass time series, required to balance out a good value.
        // source: http://stockcharts.com/school/lib/exe/fetch.php?media=chart_school:technical_indicators_and_overlays:true_strength_index:cs-tsi.xls
        private ITimeSeries GetTimeSeries()
        {
            return new MockTimeSeries(
1080.29M,
1090.10M,
1104.51M,
1091.84M,
1098.87M,
1104.18M,
1109.55M,
1121.90M,
1121.10M,
1125.07M,
1124.66M,
1125.59M,
1142.71M,
1139.78M,
1134.28M,
1124.83M,
1148.67M,
1142.16M,
1147.70M,
1144.73M,
1141.20M,
1146.24M,
1137.03M,
1160.75M,
1159.97M,
1158.06M,
1165.15M,
1165.32M,
1169.77M,
1178.10M,
1173.81M,
1176.19M,
1184.71M,
1165.90M,
1178.17M,
1180.26M,
1183.08M,
1185.62M,
1185.64M,
1182.45M,
1183.78M,
1183.26M,
1184.38M,
1193.57M,
1197.96M,
1221.06M,
1225.85M,
1223.25M,
1213.40M,
1218.71M,
1213.54M,
1199.21M,
1197.75M,
1178.34M,
1178.59M,
1196.69M,
1199.73M,
1197.84M,
1180.73M,
1198.35M,
1189.40M,
1187.76M,
1180.55M,
1206.07M,
1221.53M,
1224.71M,
1223.12M,
1223.75M,
1228.28M,
1233.00M,
1240.40M,
1240.46M,
1241.59M,
1235.23M,
1242.87M,
1243.91M,
1247.08M,
1254.60M,
1258.84M,
1256.77M,
1257.54M,
1258.51M,
1259.78M,
1257.88M,
1257.64M,
1271.89M,
1270.20M,
1276.56M,
1273.85M,
1271.50M,
1269.75M,
1274.48M,
1285.96M,
1283.76M,
1293.24M,
1295.02M,
1281.92M,
1280.26M,
1283.35M,
1290.84M,
1291.18M,
1278.36M,
1295.52M,
1287.14M,
1283.50M,
1268.45M,
1280.10M,
1296.67M,
1307.41M,
1320.64M,
1339.67M,
1337.88M,
1339.22M,
1353.22M,
1343.80M,
1319.49M,
1313.64M,
1317.72M,
1308.87M,
1316.14M,
1305.44M,
1326.73M,
1325.84M,
1343.80M,
1345.02M,
1337.43M,
1331.94M,
1304.89M,
1300.67M,
1292.28M,
1286.94M,
1254.05M,
1260.34M,
1200.07M,
1199.38M,
1119.46M,
1172.53M,
1120.76M,
1172.64M,
1178.81M,
1204.49M,
1192.76M,
1193.88M,
1140.65M,
1123.53M,
1123.82M,
1162.35M,
1177.60M,
1159.27M,
1176.80M,
1210.08M,
1212.92M,
1218.89M,
1204.42M,
1173.97M,
1165.24M,
1198.62M,
1185.90M,
1154.23M,
1162.27M,
1172.87M,
1188.68M,
1209.11M,
1216.01M,
1204.09M,
1202.09M,
1166.76M,
1129.56M,
1136.43M,
1162.95M,
1175.38M,
1151.06M,
1160.40M,
1131.42M,
1099.23M,
1123.95M,
1144.04M,
1164.97M,
1155.46M,
1194.89M,
1195.54M,
1207.25M,
1203.66M,
1224.58M,
1200.86M,
1225.38M,
1209.88M,
1215.39M,
1238.25M,
1254.19M,
1229.05M,
1242.00M,
1284.59M,
1285.08M,
1253.30M,
1218.28M,
1237.90M,
1261.15M,
1253.23M,
1261.12M,
1275.92M,
1229.10M,
1239.70M,
1263.85M,
1251.78M,
1257.81M,
1236.91M,
1216.13M,
1215.65M,
1192.98M,
1188.04M,
1161.79M,
1158.67M,
1192.55M,
1195.19M,
1246.96M,
1244.58M,
1244.28M,
1257.08M,
1258.47M,
1261.01M,
1234.35M,
1255.19M,
1236.47M,
1225.73M,
1211.82M,
1215.75M,
1219.66M,
1205.35M,
1241.30M,
1243.72M,
1254.00M,
1265.33M,
1265.43M,
1249.64M,
1263.02M,
1257.60M,
1277.06M,
1277.30M,
1281.06M,
1277.81M,
1280.70M,
1292.08M,
1292.48M,
1295.50M,
1289.09M,
1293.67M,
1308.04M,
1314.50M,
1315.38M,
1316.00M,
1314.65M,
1326.06M,
1318.43M,
1316.33M,
1313.01M,
1312.41M,
1324.09M,
1325.54M,
1344.90M,
1344.33M,
1347.05M,
1349.96M,
1351.95M,
1342.64M,
1351.77M,
1350.50M,
1343.23M,
1358.04M,
1361.23M,
1362.21M,
1357.66M,
1363.46M,
1365.74M,
1367.59M,
1372.18M,
1365.68M,
1374.09M,
1369.63M,
1364.33M,
1343.36M,
1352.63M,
1365.91M,
1370.87M,
1371.09M,
1395.95M,
1394.28M,
1402.60M,
1404.17M,
1409.75M,
1405.52M,
1402.89M,
1392.78M,
1397.11M,
1416.51M,
1412.52M,
1405.54M,
1403.28M,
1408.47M,
1419.04M,
1413.38M,
1398.96M,
1398.08M,
1382.20M,
1358.59M,
1368.71M,
1387.57M,
1370.26M,
1369.57M,
1390.78M,
1385.14M,
1376.92M,
1378.53M,
1366.94M,
1371.97M,
1390.69M,
1399.98M,
1403.36M,
1397.91M,
1405.82M,
1402.31M,
1391.57M,
1369.10M,
1369.58M,
1363.72M,
1354.58M,
1357.99M,
1353.39M,
1338.35M,
1330.66M,
1324.80M,
1304.86M,
1295.22M,
1315.99M,
1316.63M,
1318.86M,
1320.68M,
1317.82M,
1332.42M,
1313.32M,
1310.33M,
1278.04M,
1278.18M,
1285.50M,
1315.13M,
1314.99M,
1325.66M,
1308.93M,
1324.18M,
1314.88M,
1329.10M,
1342.84M,
1344.78M,
1357.98M,
1355.69M,
1325.51M,
1335.02M,
1313.72M,
1319.99M,
1331.85M,
1329.04M,
1362.16M,
1365.51M,
1374.02M,
1367.58M,
1354.68M,
1352.46M,
1341.47M,
1341.45M,
1334.76M,
1356.78M,
1353.64M,
1363.67M,
1372.78M,
1376.51M,
1362.66M,
1350.52M,
1338.31M,
1337.89M,
1360.02M,
1385.97M,
1385.30M,
1379.32M,
1375.32M,
1365.00M,
1390.99M,
1394.23M,
1401.35M,
1402.22M,
1402.80M,
1405.87M,
1404.11M,
1403.93M,
1405.53M,
1415.51M,
1418.16M,
1418.13M,
1413.17M,
1413.49M,
1402.08M,
1411.13M,
1410.44M,
1409.30M,
1410.49M);
        }
    }
}
